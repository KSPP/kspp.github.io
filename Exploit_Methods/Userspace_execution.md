# Details

Once an attacker has gain control over the instruction pointers, it must
be aimed somewhere. The place where attackers have the most control over
memory layout tends to be in userspace, so it has been natural to place
malicious code in userspace and have the kernel redirection execution
there. (Frequently known as "ret2usr".)

For more details, see [Userspace
access](Exploit_Methods/Userspace_data_usage), as that can be
superset of userspace execution under some emulation situations.

# Examples

  - See nearly every other exploit example listed under other [Exploit
    Methods](Exploit_Methods) and [Bug
    Classes](Bug_Classes).

# Mitigations

  - hardware segregation: SMEP (x86), PXN (arm)
  - compiler instrumentation to set high bit on function calls
  - emulate memory segregation via separate page tables (e.g.
    PAX_MEMORY_UDEREF)

Right now, the upstream options available for Privileged eXecute Never
(e.g. PXN, SMEP) are:

| CPU                                                       | Feature Name                             |
| --------------------------------------------------------- | ---------------------------------------- |
| ARM                                                       | v7 (32-bit) non-LPAE                     |
| v7 (32-bit) LPAE (e.g. Cortex-A7, A15+)                   | hardware PXN (since Linux v3.19)         |
| v8.0+ (64-bit)                                            | hardware PXN                             |
| x86                                                       | pre-Ivy-Bridge                           |
| Ivy-Bridge+ (since May 2012)                              | hardware PXN (SMEP)                      |
| s/390                                                     | hardware PXN (Address Spaces)            |
| powerpc                                                   | radix MMU (since POWER9)                 |
| PPC64 hash MMU (since POWER7)                             | nothing yet, but implementation possible |
| PPC32 hash MMU (except 601 which doesn't have NX segment) | hardware PXN (KUEP)                      |
| MPC 8xx                                                   | hardware PXN (KUEP)                      |
| MIPS                                                      | nothing (could use ASID switching?)      |